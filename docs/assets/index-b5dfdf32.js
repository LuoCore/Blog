/* empty css              */import{d as te,r as k,v as F,e as ae,o as y,m as $,w as s,g as t,j as f,f as P,k as I,l as se,a as v,F as le,a8 as ne,t as w,P as H,Q as n,B as oe,C as ie,I as re,S as de,$ as ue,n as ce,J as me,K as pe,x as ye,V as _e,T as fe,a5 as ge,a9 as he,U as be,M as ve,h as xe,_ as ke}from"./index-d8cbdd46.js";/* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              *//* empty css              */import{f as De,g as Se,h as $e,i as Ie}from"./basic-6ef9ceac.js";import{u as N}from"./useConfirm-4b37d2ff.js";import{u as C}from"./useLoading-886b777a.js";import{_ as we}from"./DialogEditUserInfo.vue_vue_type_script_setup_true_lang-803501d2.js";/* empty css              */const Ne=[{title:"选项",width:"55px",type:"checkbox",fixed:"left"},{key:"userId",title:"用户Id",width:"80px",fixed:"left",sort:"desc"},{key:"userName",title:"用户名称",width:"100px"},{key:"roleInfos",title:"角色",align:"center",width:"100px",customSlot:"roles"},{key:"nickname",title:"昵称",align:"center",width:"100px"},{key:"phoneTeleNumber",title:"电话号码",align:"center",width:"150px"},{key:"phoneMobileNumber",title:"手机号码",align:"center",width:"150px"},{key:"emailAddress",title:"电子邮箱",align:"center",width:"200px"},{key:"gender",title:"性别",align:"center",width:"90px",customSlot:"gender"},{key:"birthday",title:"生日",align:"center",width:"180px",customSlot:"birthday"},{key:"createTime",title:"创建时间",align:"center",width:"180px",customSlot:"createTime"},{key:"isDisable",title:"禁用",align:"center",width:"90px",customSlot:"isDisable"},{key:"operator",title:"操作",align:"left",customSlot:"operator",fixed:"right",width:"200px"}],A=function(M,_){var o=new Date(M);if(_=="yyyy-M-d"){let d=o.getFullYear(),u=o.getMonth()+1,r=o.getDate();return`${d}-${u}-${r}`}else if(_=="yyyy-M-d H:m:s"){let d=o.getFullYear(),u=o.getMonth()+1,r=o.getDate(),b=o.getHours(),m=o.getMinutes(),g=o.getSeconds();return`${d}-${u}-${r} ${b}:${m}:${g}`}else if(_=="yyyy-MM-dd"){let d=o.getFullYear(),u=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0");return`${d}-${u}-${r}`}else{let d=o.getFullYear(),u=(o.getMonth()+1).toString().padStart(2,"0"),r=o.getDate().toString().padStart(2,"0"),b=o.getHours().toString().padStart(2,"0"),m=o.getMinutes().toString().padStart(2,"0"),g=o.getSeconds().toString().padStart(2,"0");return`${d}-${u}-${r} ${b}:${m}:${g}`}},Ce={class:"table-box"},Me={style:{display:"grid"}},Ve={key:0},ze={key:1},Ue={key:2},Te={key:0},Be={key:0},Fe=te({__name:"index",setup(M){const _=k([]),o=k(!1),d=k([]),u=F({current:1,limit:100,total:0,limits:[100,500,9999]}),r=F({userId:0,gender:0,isDisable:0}),b={userId:0,userName:"",nickname:"",phoneMobileNumber:"",phoneTeleNumber:"",emailAddress:"",roleIds:[],gender:0,isDisable:!1},m=k({...b}),g=k(!1);function E(){r.gender=0,r.isDisable=0,r.userId=0,r.userName=""}function D(){u.current=1,V(u)}const V=async l=>{o.value=!0;try{const e=await De({requestData:r,currentPageNum:l.current,pageSize:l.limit});if(!e||!e.isSuccess)return;e.responseData?(_.value=e.responseData,l.total=e.pageCount):_.value=[]}finally{o.value=!1}},Y=(l,e)=>{_.value.forEach(c=>{c.userId===e.userId&&n.msg("Success",{icon:1},()=>{c.isDisable=l})})};function K(l){if(!l){n.msg("请选择用户",{icon:2,time:2e3});return}N(n,`确定要重置【${l.userName}】的密码吗？`,async e=>{n.close(e),C(n,"正在重置密码",async c=>{try{const i=await Se(l.userId);if(!i||!i.isSuccess){n.confirm(i.message||"操作失败",{icon:2});return}n.msg(i.message||"操作成功",{icon:1})}catch(i){n.msg(i.message,{icon:2})}finally{n.close(c)}})})}function z(l){m.value={...b},l&&(m.value={userId:l.userId,userName:l.userName,nickname:l.nickname,phoneMobileNumber:l.phoneMobileNumber,phoneTeleNumber:l.phoneTeleNumber,emailAddress:l.emailAddress,roleIds:[],gender:l.gender,isDisable:!1},l.isDisable&&(m.value.isDisable=l.isDisable),m.value.roleIds=l.roleInfos.map(e=>e.roleId)),g.value=!0}function L(){const l=d.value.map(e=>parseInt(e));if(l.length==0){n.msg("您未选择数据，请先选择要删除的数据",{icon:3,time:2e3});return}N(n,"您将删除所有选中的数据？",e=>{n.close(e),C(n,"正在删除数据",async c=>{try{const i=await $e(l);i.isSuccess?n.msg("您已成功删除",{icon:1}):n.msg("删除失败！"+(i==null?void 0:i.message),{icon:2}),D()}finally{n.close(c)}})},e=>{n.close(e),n.msg("您已取消操作")})}function R(l){N(n,`您将删除${l.userId}用户？`,e=>{C(n,"正在删除数据....",async c=>{try{const i=await Ie(l.userId);i.isSuccess?n.msg("您已成功删除！",{icon:1}):n.msg("删除失败！"+(i==null?void 0:i.message),{icon:2}),D()}finally{n.close(e),n.close(c)}})},e=>{n.close(e),n.msg("您已取消操作")})}function Q(){n.msg("您已取消操作")}return(l,e)=>{const c=oe,i=ie,x=re,S=de,U=ue,h=ce,j=me,q=pe,G=ye,T=_e,B=fe,J=ge,W=he,O=be,X=ve,Z=xe,ee=ae("any-permission");return y(),$(Z,{fluid:"true",class:"user-box"},{default:s(()=>[t(G,null,{default:s(()=>[t(q,{style:{"margin-top":"10px"}},{default:s(()=>[t(j,null,{default:s(()=>[t(x,{md:5},{default:s(()=>[t(i,{label:"用户Id","label-width":"80"},{default:s(()=>[t(c,{modelValue:r.userId,"onUpdate:modelValue":e[0]||(e[0]=a=>r.userId=a),placeholder:"请输入",size:"sm","allow-clear":!0,style:{width:"98%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(x,{md:5},{default:s(()=>[t(i,{label:"用户名","label-width":"80"},{default:s(()=>[t(c,{modelValue:r.userName,"onUpdate:modelValue":e[1]||(e[1]=a=>r.userName=a),placeholder:"请输入",size:"sm","allow-clear":!0,style:{width:"98%"}},null,8,["modelValue"])]),_:1})]),_:1}),t(x,{md:5},{default:s(()=>[t(i,{label:"性别","label-width":"80"},{default:s(()=>[t(U,{class:"search-input",size:"sm",modelValue:r.gender,"onUpdate:modelValue":e[2]||(e[2]=a=>r.gender=a),"allow-clear":!0,placeholder:"请选择"},{default:s(()=>[t(S,{value:1,label:"男"}),t(S,{value:2,label:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(x,{md:5},{default:s(()=>[t(i,{label:"是否禁用","label-width":"80"},{default:s(()=>[t(U,{class:"search-input",size:"sm",modelValue:r.isDisable,"onUpdate:modelValue":e[3]||(e[3]=a=>r.isDisable=a),"allow-clear":!0,placeholder:"请选择"},{default:s(()=>[t(S,{value:1,label:"不禁用"}),t(S,{value:2,label:"禁用"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(x,{md:5},{default:s(()=>[t(i,{"label-width":"20"},{default:s(()=>[t(h,{style:{"margin-left":"20px"},type:"primary",size:"sm",onClick:D},{default:s(()=>[f(" 查询 ")]),_:1}),t(h,{size:"sm",onClick:E},{default:s(()=>[f(" 重置 ")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),P("div",Ce,[t(X,{id:"userId",resize:!0,page:u,height:"100%",columns:I(Ne),loading:o.value,"default-toolbar":!0,"data-source":_.value,"selected-keys":d.value,"onUpdate:selectedKeys":e[5]||(e[5]=a=>d.value=a),onChange:V},{status:s(({row:a})=>[t(T,{"model-value":a.status,onChange:p=>Y(p,a)},null,8,["model-value","onChange"])]),toolbar:s(()=>[t(h,{size:"sm",type:"primary",onClick:e[4]||(e[4]=a=>z())},{default:s(()=>[t(B,{class:"layui-icon-addition"}),f(" 新增")]),_:1}),t(h,{size:"sm",onClick:L},{default:s(()=>[t(B,{class:"layui-icon-delete"}),f(" 删除 ")]),_:1})]),operator:s(({row:a})=>[t(h,{size:"xs",type:"primary",onClick:p=>z(a)},{default:s(()=>[f("编辑")]),_:2},1032,["onClick"]),t(J,{content:"确定要删除此用户吗?",onConfirm:p=>R(a),onCancel:Q},{default:s(()=>[t(h,{size:"xs",border:"red","border-style":"dashed"},{default:s(()=>[f("删除")]),_:1})]),_:2},1032,["onConfirm"]),se((y(),$(h,{size:"xs",onClick:p=>K(a)},{default:s(()=>[f(" 重置密码 ")]),_:2},1032,["onClick"])),[[ee,["sys:user:edit","sys:user:update"]]])]),avatar:s(({row:a})=>[t(W,{src:a.avatar},null,8,["src"])]),roles:s(({row:a})=>[P("div",Me,[(y(!0),v(le,null,ne(a.roleInfos,p=>(y(),$(O,{key:p.roleId,"max-width":"100px",style:{margin:"2px"}},{default:s(()=>[f(w((p==null?void 0:p.roleName)||"无"),1)]),_:2},1024))),128))])]),gender:s(({row:a})=>[a.gender==1?(y(),v("span",Ve,"男")):a.gender==0?(y(),v("span",ze,"女")):(y(),v("span",Ue,"未知"))]),createTime:s(({row:a})=>[a.createTime?(y(),v("span",Te,w(I(A)(a.createTime,"yyyy-M-d H:m:s")),1)):H("",!0)]),birthday:s(({row:a})=>[a.birthday?(y(),v("span",Be,w(I(A)(a.birthday,"yyyy-M-d H:m:s")),1)):H("",!0)]),isDisable:s(({row:a})=>[t(T,{"model-value":a.isDisable,"onswitch-text":"是","onswitch-value":!0,"unswitch-text":"否","unswitch-value":!1},null,8,["model-value"])]),_:1},8,["page","columns","loading","data-source","selected-keys"])]),t(we,{visible:g.value,"onUpdate:visible":e[6]||(e[6]=a=>g.value=a),"form-data":m.value,onDone:D},null,8,["visible","form-data"])]),_:1})}}});const We=ke(Fe,[["__scopeId","data-v-1b689be8"]]);export{We as default};

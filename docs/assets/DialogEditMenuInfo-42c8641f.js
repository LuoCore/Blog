import{d as j,r as c,v as z,W as F,X as G,o as O,m as W,w as o,f as A,g as l,j as w,Q as d,Y as H,C as J,B as K,T as Q,Z as X,a0 as Y,a1 as Z,a2 as L,a3 as P,V as R,K as ee,a4 as ae,_ as ne}from"./index-dfc0ddb4.js";/* empty css              *//* empty css              *//* empty css              */import{E as le,a as te}from"./basic-13552516.js";const oe={style:{padding:"20px"}},se=j({__name:"DialogEditMenuInfo",props:{visible:{type:Boolean,default:!1},formData:{},parentId:{default:0}},emits:["update:visible","done"],setup(h,{emit:T}){const i=c(),p=c(!1),f=c([]),r=h,g=T,v={menuId:0,menuName:"",parentId:0,menuIcon:"",menuUrl:"",menuType:0,sortId:0,isDisable:!1},n=z({...v}),_=F({get(){return r.visible},set(a){g("update:visible",a)}});G(()=>{console.log(`count is now: ${r.visible}`),r.visible&&(D(),Object.assign(n,v),r.parentId>0?(n.parentId=r.parentId,p.value=!0):r.formData&&Object.assign(n,r.formData))});function V(a){const e={id:a.menuId,title:a.menuName,field:a.parentId,children:void 0};if(a.childrenMenus&&a.childrenMenus.length>0){const m=a.childrenMenus.map(s=>V(s));e.children=m}return e}async function D(){try{const a=await te();if(a){if(!a.isSuccess||!a.responseData){d.msg(`获取菜单列表失败:${a.message}`,{icon:2});return}}else{d.msg("获取菜单列表失败",{icon:2});return}f.value=[{id:0,title:"父级",field:"",children:[]}],a.responseData.map(e=>{f.value[0].children.push(V(e))})}catch(a){d.msg(a.message,{icon:2})}}function M(a){n.parentId=Number(a)}function U(a){n.menuType=a}const C=c({parentId:{type:"number",required:!0,message:"父级Id不能为空"},menuName:{type:"string",required:!0,message:"菜单名称不能为空"},menuType:{type:"number",required:!0,message:"菜单类型不能为空"},sortId:{type:"number",required:!0,message:"排序号不能为空"},isDisable:{type:"boolean",required:!0,message:"是否禁用不能为空"}});function y(){var a;i.value.reset(),(a=i.value)==null||a.clearValidate(),_.value=!1,p.value=!1}function N(){i.value.validate((a,e,m)=>{a&&d.msg("正在提交数据...",{icon:16,time:0,shade:!0,success:async s=>{try{var u=await le(e);u&&u.isSuccess?(d.msg("操作成功",{icon:1}),g("done"),y()):d.confirm("操作失败！"+(u==null?void 0:u.message),{icon:2})}catch{}finally{d.close(s)}}})})}return(a,e)=>{const m=H,s=J,u=K,b=Q,I=X,x=Y,B=Z,q=L,k=P,E=R,$=ee,S=ae;return O(),W(S,{modelValue:_.value,"onUpdate:modelValue":e[9]||(e[9]=t=>_.value=t),area:"600px",resize:!0,size:"md",title:"菜单编辑","shade-close":!1,move:!0,maxmin:!0,btnAlign:"c",btn:[{text:"提交",callback:()=>N()},{text:"关闭",callback:()=>y()}],onClose:y},{default:o(()=>[A("div",oe,[l($,{ref_key:"refForm",ref:i,model:n,rules:C.value,style:{padding:"10px"}},{default:o(()=>[l(s,{label:"上级菜单",prop:"parentId",required:""},{default:o(()=>[l(m,{modelValue:n.parentId,"onUpdate:modelValue":e[0]||(e[0]=t=>n.parentId=t),"allow-clear":!0,search:!0,data:f.value,disabled:p.value,style:{width:"100%"},onChange:e[1]||(e[1]=t=>M(t))},null,8,["modelValue","data","disabled"])]),_:1}),l(s,{label:"菜单名称",prop:"menuName",required:""},{default:o(()=>[l(u,{modelValue:n.menuName,"onUpdate:modelValue":e[2]||(e[2]=t=>n.menuName=t),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),l(s,{prop:"menuUrl"},{label:o(()=>[w(" 路由地址 "),l(I,{content:n.menuType==0?"如果类型是菜单，需要写菜单路由":"如果类型是按钮，路由地址可以不用填写"},{default:o(()=>[l(b,{type:"layui-icon-about"})]),_:1},8,["content"])]),default:o(()=>[l(u,{modelValue:n.menuUrl,"onUpdate:modelValue":e[3]||(e[3]=t=>n.menuUrl=t),placeholder:"请填写","allow-clear":""},null,8,["modelValue"])]),_:1}),l(s,{label:"菜单类型",prop:"menuType",required:""},{default:o(()=>[l(B,{modelValue:n.menuType,"onUpdate:modelValue":e[4]||(e[4]=t=>n.menuType=t),name:"menuType",onChange:e[5]||(e[5]=t=>U(t))},{default:o(()=>[l(x,{value:1,label:"菜单"}),l(x,{value:2,label:"按钮"})]),_:1},8,["modelValue"])]),_:1}),l(s,{label:"菜单图标",prop:"menuIcon"},{default:o(()=>[l(q,{modelValue:n.menuIcon,"onUpdate:modelValue":e[6]||(e[6]=t=>n.menuIcon=t),"allow-clear":""},null,8,["modelValue"])]),_:1}),l(s,{label:"排序",prop:"sortId"},{default:o(()=>[l(k,{modelValue:n.sortId,"onUpdate:modelValue":e[7]||(e[7]=t=>n.sortId=t),position:"right",min:0},null,8,["modelValue"])]),_:1}),l(s,{prop:"isShow",class:"switch-fix"},{label:o(()=>[w(" 是否禁用 "),l(I,{content:"如果禁用，则不会出现在左侧菜单栏"},{default:o(()=>[l(b,{type:"layui-icon-about"})]),_:1})]),default:o(()=>[l(E,{modelValue:n.isDisable,"onUpdate:modelValue":e[8]||(e[8]=t=>n.isDisable=t),"onswitch-value":!0,"onswitch-text":"是","unswitch-value":!1,"unswitch-text":"否"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue","btn"])}}});const ce=ne(se,[["__scopeId","data-v-9f64ad9d"]]);export{ce as default};
